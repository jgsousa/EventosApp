var mainApp=angular.module("mainApp",["ngRoute","ngToast","ui.bootstrap","nvd3","ui.grid","ui.grid.edit","ui.grid.grouping","ui.grid.exporter","ui.grid.pinning","angularSpinner"]);mainApp.config(["$routeProvider",function(a){a.when("/main",{templateUrl:"pages/main/main.html",controller:"mainController"}).when("/users",{templateUrl:"pages/user/users.html",controller:"usersController"}).when("/users/:id",{templateUrl:"pages/user/usersdetail.html",controller:"usersDetailController"}).when("/criaruser",{templateUrl:"pages/user/criaruser.html",controller:"criarUserController"}).when("/eventos",{templateUrl:"pages/eventos/eventos.html",controller:"eventosController"}).when("/eventos/:id",{templateUrl:"pages/eventos/eventosdetail.html",controller:"eventosDetailController"}).when("/criarevento",{templateUrl:"pages/eventos/eventosdetail.html",controller:"criarEventosController"}).when("/sessoes",{templateUrl:"pages/sessoes/sessoes.html",controller:"sessoesController"}).when("/sessoes/:id",{templateUrl:"pages/sessoes/sessoesdetail.html",controller:"sessoesDetailController"}).when("/criarsessao",{templateUrl:"pages/sessoes/sessoesdetail.html",controller:"criarSessoesController"}).when("/speakers",{templateUrl:"pages/speakers/speakers.html",controller:"speakersController"}).when("/speakers/:id",{templateUrl:"pages/speakers/speakersdetail.html",controller:"speakersDetailController"}).when("/criarspeaker",{templateUrl:"pages/speakers/speakersdetail.html",controller:"criarSpeakersController"}).when("/participantes",{templateUrl:"pages/participantes/participantes.html",controller:"participantesController"}).when("/participantes/:id",{templateUrl:"pages/participantes/participantesdetail.html",controller:"participantesDetailController"}).when("/criarparticipante",{templateUrl:"pages/participantes/participantesdetail.html",controller:"criarParticipantesController"}).when("/login",{templateUrl:"pages/users/login.html"}).otherwise({redirectTo:"/main"})}]),mainApp.config(["ngToastProvider",function(a){a.configure({verticalPosition:"top",horizontalPosition:"right",maxNumber:3,timeout:2e3,dismissOnTimeout:!0})}]),mainApp.controller("navController",["$scope",function(a){a.funcao1="Utilizadores",a.funcao2="Backlog",a.funcao3="Recursos",a.funcao4="Projectos",a.funcao5="Budget"}]);var BinaryFileReader={read:function(a,b){var c=new FileReader,d={name:a.name,type:a.type,size:a.size,file:null};c.onload=function(){d.file=new Uint8Array(c.result),b(null,d)},c.onerror=function(){b(c.error)},c.readAsArrayBuffer(a)}};mainApp.controller("eventosController",["$scope","$filter","EventoServices","ngToast",function(a,b,c,d){c.getAllEventos().then(function(b){a.eventos=b},function(a){})}]),mainApp.controller("eventosDetailController",["$scope","$routeParams","$location","EventoServices","ngToast",function(a,b,c,d,e){d.getEventoForId(b.id).then(function(b){b?(a.data=b,a.data.dataInicio=new Date(a.data.dataInicio),a.data.dataFim=new Date(a.data.dataFim)):c.path("/eventos/")},function(a){}),a.gravar=function(){a.criarForm.$valid&&d.updateEvento(b.id,a.data).then(function(a){e.create("Gravado com sucesso"),c.path("/eventos/")},function(a){})},a.uploadFile=function(a){var c=a.target.files[0];BinaryFileReader.read(c,function(a,c){var e={};e.eventoId=b.id,e.file=c,d.uploadFile(b.id,e)})}}]),mainApp.controller("criarEventosController",["$scope","$location","EventoServices","ngToast",function(a,b,c,d){a.gravar=function(){a.criarForm.$valid?c.createEvento(a.data).then(function(){d.create("Gravado com sucesso"),b.path("/eventos/")},function(a){}):d.create("Erro")}}]),mainApp.controller("participantesController",["$scope","$filter","ParticipanteServices",function(a,b,c){c.getAllParticipantes().then(function(b){a.participantes=b},function(a){})}]),mainApp.controller("participantesDetailController",["$scope","$routeParams","$location","ParticipanteServices","ngToast",function(a,b,c,d,e){d.getParticipanteForId(b.id).then(function(b){b?a.data=b:c.path("/participantes/")},function(a){}),a.gravar=function(){a.criarForm.$valid&&d.updateParticipante(b.id,a.data).then(function(a){e.create("Gravado com sucesso"),c.path("/participantes/")},function(a){})}}]),mainApp.controller("criarParticipantesController",["$scope","$location","ParticipanteServices","ngToast",function(a,b,c,d){a.gravar=function(){a.criarForm.$valid?c.createParticipante(a.data).then(function(){d.create("Gravado com sucesso"),b.path("/participantes/")},function(a){}):d.create("Erro")}}]),mainApp.controller("sessoesController",["$scope","$filter","SessaoServices",function(a,b,c){c.getAllSessaos().then(function(b){a.sessoes=b},function(a){})}]),mainApp.controller("sessoesDetailController",["$scope","$routeParams","$location","SessaoServices","ngToast","EventoServices","SpeakerServices",function(a,b,c,d,e,f,g){f.getAllEventos().then(function(b){if(a.eventos=b,a.data.eventoId)for(var c=0;c<b.length;c++)b[c]._id==a.data.eventoId&&(a.data.evento=b[c].nome)}),g.getAllSpeakers().then(function(b){a.oradores=b}),d.getSessaoForId(b.id).then(function(b){if(b){if(a.data=b,a.data.dataInicio=new Date(a.data.dataInicio),a.data.dataFim=new Date(a.data.dataFim),a.data.orador=b.speaker.nome,a.eventos)for(var d=0;d<a.eventos.length;d++)a.eventos[d]._id==a.data.eventoId&&(a.data.evento=a.eventos[d].nome)}else c.path("/sessoes/")},function(a){}),a.gravar=function(){a.criarForm.$valid&&d.updateSessao(b.id,a.data).then(function(a){e.create("Gravado com sucesso"),c.path("/sessoes/")},function(a){})},a.dropSelected=function(b){a.data.eventoId=b._id,a.data.evento=b.nome},a.dropSelectedSpeaker=function(b){a.data.speaker=b,a.data.orador=b.nome}}]),mainApp.controller("criarSessoesController",["$scope","$location","SessaoServices","ngToast","EventoServices","SpeakerServices",function(a,b,c,d,e,f){a.data={},e.getAllEventos().then(function(b){a.eventos=b}),f.getAllSpeakers().then(function(b){a.oradores=b}),a.dropSelected=function(b){a.data.eventoId=b._id,a.data.evento=b.nome},a.dropSelectedSpeaker=function(b){a.data.speaker=b,a.data.orador=b.nome},a.gravar=function(){a.criarForm.$valid?c.createSessao(a.data).then(function(){d.create("Gravado com sucesso"),b.path("/sessoes/")},function(a){}):d.create("Erro")}}]),mainApp.controller("speakersController",["$scope","$filter","SpeakerServices",function(a,b,c){c.getAllSpeakers().then(function(b){a.speakers=b},function(a){})}]),mainApp.controller("speakersDetailController",["$scope","$routeParams","$location","SpeakerServices","ngToast",function(a,b,c,d,e){d.getSpeakerForId(b.id).then(function(b){b?a.data=b:c.path("/speakers/")},function(a){}),a.gravar=function(){a.criarForm.$valid&&d.updateSpeaker(b.id,a.data).then(function(a){e.create("Gravado com sucesso"),c.path("/speakers/")},function(a){})}}]),mainApp.controller("criarSpeakersController",["$scope","$location","SpeakerServices","ngToast",function(a,b,c,d){a.gravar=function(){a.criarForm.$valid?c.createSpeaker(a.data).then(function(){d.create("Gravado com sucesso"),b.path("/speakers/")},function(a){}):d.create("Erro")}}]),mainApp.controller("usersController",["$scope","UserServices","$q","ModalServices",function(a,b,c,d){b.getAllUsers().then(function(b){a.users=b},function(a){});var e=function(c){return b.deleteUser(a.selected._id)},f=function(){var b=a.users.indexOf(a.selected);b>-1&&a.users.splice(b,1)};a.requestDeleteSelected=function(b){a.selected=b;var c=d.popUpToConfirm("Deseja apagar este utilizador?");c.result.then(e).then(f)}}]),mainApp.controller("usersDetailController",["$scope","$routeParams","ngToast","UserServices","$location",function(a,b,c,d,e){d.getUserForId(b.id).then(function(b){b?a.userData=b:e.path("/users/")},function(a){}),a.gravar=function(){a.modificarForm.$valid&&d.updateUser(b.id,a.userData).then(function(a){c.create("Gravado com sucesso")},function(a){})}}]),mainApp.controller("criarUserController",["$scope","$routeParams","ngToast","UserServices",function(a,b,c,d){a.gravar=function(){a.criarForm.$valid&&(a.userData.password==a.confirmPass?d.createUser(a.userData).then(function(){c.create("Gravado com sucesso")},function(a){}):c.danger("Passwords não são identicas"))}}]),mainApp.service("EventoServices",["$http","$q",function(a,b){this.getAllEventos=function(){return a.get("/eventos/").then(function(a){return a.data})},this.getEventoForId=function(c){return a.get("/eventos/"+c).then(function(a){return a.data},function(a){b.reject(a.data)})},this.createEvento=function(b){return a.post("/eventos/create",b,{}).then(function(a){return a.data})},this.updateEvento=function(b,c){return a.put("/eventos/"+b,c,{}).then(function(a){return a.data})},this.deleteEvento=function(b){return a["delete"]("/eventos/"+b,{}).then(function(a){return b})},this.uploadFile=function(b,c){return a.post("/eventos/"+b+"/doc",c).then(function(a){return b})}}]),mainApp.service("FileServices",[function(){this.CSVToArray=function(a,b){b=b||";";for(var c=new RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),d=[[]],e=null;e=c.exec(a);){var f=e[1];f.length&&f!==b&&d.push([]);var g;g=e[2]?e[2].replace(new RegExp('""',"g"),'"'):e[3],d[d.length-1].push(g)}return d},this.XLSXToArray=function(a){var b=XLSX.read(a,{type:"binary"}),c=[];return b.SheetNames.forEach(function(a){var d=XLSX.utils.sheet_to_row_object_array(b.Sheets[a]);d.length>0&&c.push(d)}),c[0]},this.isListaRecursosValid=function(a){var b=a[0];if(b){var c=Object.keys(b),d=c.indexOf("codigo"),e=c.indexOf("rateHora"),f=c.indexOf("nome"),g=c.indexOf("nivel");return!(-1==d||-1==e||-1==f||-1==g)}return!1}}]),mainApp.service("ModalServices",["$modal",function(a){this.showSpinner=function(){return a.open({animation:!0,templateUrl:"/modals/spinner.html",controller:"spinnerController",size:"m",backdrop:"static",keyboard:"false"})},this.showFileValidation=function(b){return a.open({animation:!0,templateUrl:"/modals/confirmFile.html",controller:"confirmFileController",size:"l",resolve:{elements:function(){return b}}})},this.popUpToConfirm=function(b){return a.open({animation:!0,templateUrl:"/modals/popToConfirm.html",controller:"popToConfirmController",size:"sm",resolve:{texto:function(){return b}}})}}]),mainApp.service("ParticipanteServices",["$http","$q",function(a,b){this.getAllParticipantes=function(){return a.get("/participantes/").then(function(a){return a.data})},this.getParticipanteForId=function(c){return a.get("/participantes/"+c).then(function(a){return a.data},function(a){b.reject(a.data)})},this.createParticipante=function(b){return a.post("/participantes/create",b,{}).then(function(a){return a.data})},this.updateParticipante=function(b,c){return a.put("/participantes/"+b,c,{}).then(function(a){return a.data})},this.deleteParticipante=function(b){return a["delete"]("/participantes/"+b,{}).then(function(a){return b})}}]),mainApp.service("SessaoServices",["$http","$q",function(a,b){this.getAllSessaos=function(){return a.get("/sessoes/").then(function(a){return a.data})},this.getSessaoForId=function(c){return a.get("/sessoes/"+c).then(function(a){return a.data},function(a){b.reject(a.data)})},this.createSessao=function(b){return a.post("/sessoes/create",b,{}).then(function(a){return a.data})},this.updateSessao=function(b,c){return a.put("/sessoes/"+b,c,{}).then(function(a){return a.data})},this.deleteSessao=function(b){return a["delete"]("/sessoes/"+b,{}).then(function(a){return b})}}]),mainApp.service("SpeakerServices",["$http","$q",function(a,b){this.getAllSpeakers=function(){return a.get("/speakers/").then(function(a){return a.data})},this.getSpeakerForId=function(c){return a.get("/speakers/"+c).then(function(a){return a.data},function(a){b.reject(a.data)})},this.createSpeaker=function(b){return a.post("/speakers/create",b,{}).then(function(a){return a.data})},this.updateSpeaker=function(b,c){return a.put("/speakers/"+b,c,{}).then(function(a){return a.data})},this.deleteSpeaker=function(b){return a["delete"]("/speakers/"+b,{}).then(function(a){return b})}}]),mainApp.service("UserServices",["$http","$q",function(a,b){this.getAllUsers=function(){return a.get("/users/utilizadores").then(function(a){return a.data})},this.getUserForId=function(c){return a.get("/users/utilizadores/"+c).then(function(a){return a.data},function(a){b.reject(a.data)})},this.createUser=function(b){return a.post("/users/utilizadores",b,{}).then(function(a){return a.data})},this.updateUser=function(b,c){return a.put("/users/utilizadores/"+b,c,{}).then(function(a){return a.data})},this.deleteUser=function(b){return a["delete"]("/users/utilizadores/"+b,{}).then(function(a){return b})}}]),!function(a,b){"object"==typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return m[e]||(k.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",k.cssRules.length),m[e]=1),e}function d(a,b){var c,d,e=a.style;if(b=b.charAt(0).toUpperCase()+b.slice(1),void 0!==e[b])return b;for(d=0;d<l.length;d++)if(c=l[d]+b,void 0!==e[c])return c}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}k.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.scale*d.width,left:d.scale*d.radius,top:-d.scale*d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.scale*(d.length+d.width),k=2*d.scale*j,l=-(d.width+d.length)*d.scale*2+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k,l=["webkit","Moz","ms","O"],m={},n={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=a(null,{className:d.className});if(e(f,{position:d.position,width:0,zIndex:d.zIndex,left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.scale*(f.length+f.width)+"px",height:f.scale*f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.scale*f.radius+"px,0)",borderRadius:(f.corners*f.scale*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.scale*f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),"undefined"!=typeof document){k=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}();var o=e(a("group"),{behavior:"url(#default#VML)"});!d(o,"transform")&&o.adj?i():j=d(o,"animation")}return h}),mainApp.controller("confirmFileController",["$scope","$modalInstance","elements",function(a,b,c){a.elements=c,a.element=a.elements[0],a.keys=Object.keys(a.element),a.ok=function(){b.close("ok")},a.cancel=function(){b.dismiss("cancel")}}]),mainApp.controller("popToConfirmController",["$scope","$modalInstance","texto",function(a,b,c){a.mensagem=c,a.ok=function(){b.close("ok")},a.cancel=function(){b.dismiss("cancel")}}]),mainApp.controller("spinnerController",["$scope","$modalInstance",function(a,b){a.cancel=function(){b.dismiss("cancel")}}]),mainApp.directive("inputOnChange",function(){return{restrict:"A",link:function(a,b,c){var d=a.$eval(c.inputOnChange);b.bind("change",d)}}}),mainApp.directive("fileTable",function(){return{restrict:"E",scope:{tableData:"=dados",keys:"=keys"},template:function(a,b){var c='<table class="table"><thead><tr><th ng-repeat="key in keys">{{key}}</th></tr></thead><tbody><tr ng-repeat="element in tableData"><td ng-repeat="key in keys">{{element[key]}}</td></tr></tbody></table>';return c}}}),mainApp.directive("loadingSpinner",function(){return{restrict:"A",replace:!0,transclude:!0,scope:{loading:"=loadingSpinner"},templateUrl:"directives/templates/loading.html",link:function(a,b,c){var d=(new Spinner).spin(),e=b.find(".loading-spinner-container")[0];e.appendChild(d.el)}}});